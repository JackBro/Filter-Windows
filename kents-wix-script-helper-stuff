<Component Id="MicrosoftNetHttpHeadersdll" Guid="{C993340A-9BFC-439D-85C0-32879B7D68D4}" Win64="$(var.Win64)"><File Id="MicrosoftNetHttpHeadersdllDll" Name="Microsoft.Net.Http.Headers.dll" KeyPath="yes" AssemblyManifest="MicrosoftNetHttpHeadersdllDll" AssemblyApplication="MicrosoftNetHttpHeadersdllDll" /></Component>
<Component Id="MicrosoftPracticesServiceLocation" Guid="{08D47F64-5A00-49EE-BCAF-94F2141C35C7}" Win64="$(var.Win64)"><File Id="MicrosoftPracticesServiceLocationDll" Name="Microsoft.Practices.ServiceLocation.dll" KeyPath="yes" AssemblyManifest="MicrosoftPracticesServiceLocationDll" AssemblyApplication="MicrosoftPracticesServiceLocationDll" /></Component>
<Component Id="MicrosoftWin32Primitives" Guid="{A38B439E-9ADC-4B8B-9878-34EB26FF4023}" Win64="$(var.Win64)"><File Id="MicrosoftWin32PrimitivesDll" Name="Microsoft.Win32.Primitives.dll" KeyPath="yes" AssemblyManifest="MicrosoftWin32PrimitivesDll" AssemblyApplication="MicrosoftWin32PrimitivesDll" /></Component>
<Component Id="netstandard" Guid="{CCF63B3B-4BCB-4082-A982-4ACDAB00A00D}" Win64="$(var.Win64)"><File Id="netstandardDll" Name="netstandard.dll" KeyPath="yes" AssemblyManifest="netstandardDll" AssemblyApplication="netstandardDll" /></Component>
<Component Id="StreamExtended" Guid="{BD365CFC-7A6F-4C88-86D7-14B4C46BE364}" Win64="$(var.Win64)"><File Id="StreamExtendedDll" Name="StreamExtended.dll" KeyPath="yes" AssemblyManifest="StreamExtendedDll" AssemblyApplication="StreamExtendedDll" /></Component>
<Component Id="SystemBuffers" Guid="{3F36349B-214B-45C7-97FB-B49138EC6EFB}" Win64="$(var.Win64)"><File Id="SystemBuffersDll" Name="System.Buffers.dll" KeyPath="yes" AssemblyManifest="SystemBuffersDll" AssemblyApplication="SystemBuffersDll" /></Component>
<Component Id="SystemComponentModelPrimitives" Guid="{0322F459-3C27-4EB4-B900-652DED0C143D}" Win64="$(var.Win64)"><File Id="SystemComponentModelPrimitivesDll" Name="System.ComponentModel.Primitives.dll" KeyPath="yes" AssemblyManifest="SystemComponentModelPrimitivesDll" AssemblyApplication="SystemComponentModelPrimitivesDll" /></Component>
<Component Id="SystemComponentModelTypeConverter" Guid="{CB3A823C-2F2C-4E7C-A4CE-96730AEE4A6C}" Win64="$(var.Win64)"><File Id="SystemComponentModelTypeConverterDll" Name="System.ComponentModel.TypeConverter.dll" KeyPath="yes" AssemblyManifest="SystemComponentModelTypeConverterDll" AssemblyApplication="SystemComponentModelTypeConverterDll" /></Component>
<Component Id="SystemDataCommon" Guid="{D2EF4562-6F67-4233-A090-8E8C48923A2C}" Win64="$(var.Win64)"><File Id="SystemDataCommonDll" Name="System.Data.Common.dll" KeyPath="yes" AssemblyManifest="SystemDataCommonDll" AssemblyApplication="SystemDataCommonDll" /></Component>
<Component Id="SystemDiagnosticsDiagnosticSource" Guid="{E8D19985-9C56-487E-B475-D2AB30A07DFD}" Win64="$(var.Win64)"><File Id="SystemDiagnosticsDiagnosticSourceDll" Name="System.Diagnostics.DiagnosticSource.dll" KeyPath="yes" AssemblyManifest="SystemDiagnosticsDiagnosticSourceDll" AssemblyApplication="SystemDiagnosticsDiagnosticSourceDll" /></Component>
<Component Id="SystemDiagnosticsFileVersionInfo" Guid="{F35CAB28-FCA1-4F68-A211-47C97EB97266}" Win64="$(var.Win64)"><File Id="SystemDiagnosticsFileVersionInfoDll" Name="System.Diagnostics.FileVersionInfo.dll" KeyPath="yes" AssemblyManifest="SystemDiagnosticsFileVersionInfoDll" AssemblyApplication="SystemDiagnosticsFileVersionInfoDll" /></Component>
<Component Id="SystemDiagnosticsProcess" Guid="{36F59BC9-A188-425D-A72C-DAD14DFFBD98}" Win64="$(var.Win64)"><File Id="SystemDiagnosticsProcessDll" Name="System.Diagnostics.Process.dll" KeyPath="yes" AssemblyManifest="SystemDiagnosticsProcessDll" AssemblyApplication="SystemDiagnosticsProcessDll" /></Component>
<Component Id="SystemDiagnosticsTextWriterTraceListener" Guid="{07FF0DF8-4924-4915-A314-9F183198D1E1}" Win64="$(var.Win64)"><File Id="SystemDiagnosticsTextWriterTraceListenerDll" Name="System.Diagnostics.TextWriterTraceListener.dll" KeyPath="yes" AssemblyManifest="SystemDiagnosticsTextWriterTraceListenerDll" AssemblyApplication="SystemDiagnosticsTextWriterTraceListenerDll" /></Component>
<Component Id="SystemDiagnosticsTraceSource" Guid="{3136B0A9-7230-4EFF-87D3-F63FC07F1847}" Win64="$(var.Win64)"><File Id="SystemDiagnosticsTraceSourceDll" Name="System.Diagnostics.TraceSource.dll" KeyPath="yes" AssemblyManifest="SystemDiagnosticsTraceSourceDll" AssemblyApplication="SystemDiagnosticsTraceSourceDll" /></Component>
<Component Id="SystemDrawingPrimitives" Guid="{7CE130DF-9215-422A-8780-64530E9D10E3}" Win64="$(var.Win64)"><File Id="SystemDrawingPrimitivesDll" Name="System.Drawing.Primitives.dll" KeyPath="yes" AssemblyManifest="SystemDrawingPrimitivesDll" AssemblyApplication="SystemDrawingPrimitivesDll" /></Component>
<Component Id="SystemGlobalizationCalendars" Guid="{3B132C51-A8CB-498C-8AEB-6CE00857A6C9}" Win64="$(var.Win64)"><File Id="SystemGlobalizationCalendarsDll" Name="System.Globalization.Calendars.dll" KeyPath="yes" AssemblyManifest="SystemGlobalizationCalendarsDll" AssemblyApplication="SystemGlobalizationCalendarsDll" /></Component>
<Component Id="SystemGlobalizationExtensions" Guid="{37030AAD-217F-43F6-8A94-37743B5C96F1}" Win64="$(var.Win64)"><File Id="SystemGlobalizationExtensionsDll" Name="System.Globalization.Extensions.dll" KeyPath="yes" AssemblyManifest="SystemGlobalizationExtensionsDll" AssemblyApplication="SystemGlobalizationExtensionsDll" /></Component>
<Component Id="SystemIOCompressionZipFile" Guid="{F748D30E-0816-4B8C-AF48-C6B627057DF3}" Win64="$(var.Win64)"><File Id="SystemIOCompressionZipFileDll" Name="System.IO.Compression.ZipFile.dll" KeyPath="yes" AssemblyManifest="SystemIOCompressionZipFileDll" AssemblyApplication="SystemIOCompressionZipFileDll" /></Component>
<Component Id="SystemIOFileSystemDriveInfo" Guid="{6A6200A6-47B1-4344-B1A5-742DC4641006}" Win64="$(var.Win64)"><File Id="SystemIOFileSystemDriveInfoDll" Name="System.IO.FileSystem.DriveInfo.dll" KeyPath="yes" AssemblyManifest="SystemIOFileSystemDriveInfoDll" AssemblyApplication="SystemIOFileSystemDriveInfoDll" /></Component>
<Component Id="SystemIOFileSystemWatcher" Guid="{B85FD38A-7191-4D0D-892F-8835B4CF732F}" Win64="$(var.Win64)"><File Id="SystemIOFileSystemWatcherDll" Name="System.IO.FileSystem.Watcher.dll" KeyPath="yes" AssemblyManifest="SystemIOFileSystemWatcherDll" AssemblyApplication="SystemIOFileSystemWatcherDll" /></Component>
<Component Id="SystemIOIsolatedStorage" Guid="{2288F3EB-2443-43DA-A729-DFE7CF03F21B}" Win64="$(var.Win64)"><File Id="SystemIOIsolatedStorageDll" Name="System.IO.IsolatedStorage.dll" KeyPath="yes" AssemblyManifest="SystemIOIsolatedStorageDll" AssemblyApplication="SystemIOIsolatedStorageDll" /></Component>
<Component Id="SystemIOMemoryMappedFiles" Guid="{4926D0F7-DBFC-45AD-A49F-68B7EAB3097A}" Win64="$(var.Win64)"><File Id="SystemIOMemoryMappedFilesDll" Name="System.IO.MemoryMappedFiles.dll" KeyPath="yes" AssemblyManifest="SystemIOMemoryMappedFilesDll" AssemblyApplication="SystemIOMemoryMappedFilesDll" /></Component>
<Component Id="SystemIOPipes" Guid="{C136B7E0-B652-43F7-8A1E-20F5F6934AF7}" Win64="$(var.Win64)"><File Id="SystemIOPipesDll" Name="System.IO.Pipes.dll" KeyPath="yes" AssemblyManifest="SystemIOPipesDll" AssemblyApplication="SystemIOPipesDll" /></Component>
<Component Id="SystemIOUnmanagedMemoryStream" Guid="{C8E41908-7F70-4BED-A22E-6C5A3DD2FEEA}" Win64="$(var.Win64)"><File Id="SystemIOUnmanagedMemoryStreamDll" Name="System.IO.UnmanagedMemoryStream.dll" KeyPath="yes" AssemblyManifest="SystemIOUnmanagedMemoryStreamDll" AssemblyApplication="SystemIOUnmanagedMemoryStreamDll" /></Component>
<Component Id="SystemNetNameResolution" Guid="{9F40FD82-5B4A-49A6-B968-E884A6BEEE70}" Win64="$(var.Win64)"><File Id="SystemNetNameResolutionDll" Name="System.Net.NameResolution.dll" KeyPath="yes" AssemblyManifest="SystemNetNameResolutionDll" AssemblyApplication="SystemNetNameResolutionDll" /></Component>
<Component Id="SystemNetPing" Guid="{AE1A7798-055D-4164-A322-28DF51AF72DD}" Win64="$(var.Win64)"><File Id="SystemNetPingDll" Name="System.Net.Ping.dll" KeyPath="yes" AssemblyManifest="SystemNetPingDll" AssemblyApplication="SystemNetPingDll" /></Component>
<Component Id="SystemNetRequests" Guid="{B1F5C4E4-CDA7-4F2C-9E4F-8ADB4D07C3C3}" Win64="$(var.Win64)"><File Id="SystemNetRequestsDll" Name="System.Net.Requests.dll" KeyPath="yes" AssemblyManifest="SystemNetRequestsDll" AssemblyApplication="SystemNetRequestsDll" /></Component>
<Component Id="SystemNetSockets" Guid="{4707520B-9938-4CAE-B858-EBBB828C1B95}" Win64="$(var.Win64)"><File Id="SystemNetSocketsDll" Name="System.Net.Sockets.dll" KeyPath="yes" AssemblyManifest="SystemNetSocketsDll" AssemblyApplication="SystemNetSocketsDll" /></Component>
<Component Id="SystemNetWebSocketsClient" Guid="{3C3ADC3C-7C0C-4390-AE1F-1EA8F2DDC25B}" Win64="$(var.Win64)"><File Id="SystemNetWebSocketsClientDll" Name="System.Net.WebSockets.Client.dll" KeyPath="yes" AssemblyManifest="SystemNetWebSocketsClientDll" AssemblyApplication="SystemNetWebSocketsClientDll" /></Component>
<Component Id="SystemNetWebSockets" Guid="{4F5FD2CD-18C9-4700-868C-D46E9FC23040}" Win64="$(var.Win64)"><File Id="SystemNetWebSocketsDll" Name="System.Net.WebSockets.dll" KeyPath="yes" AssemblyManifest="SystemNetWebSocketsDll" AssemblyApplication="SystemNetWebSocketsDll" /></Component>
<Component Id="SystemReflectionReader" Guid="{6CAA4B63-E4AA-4C46-BA7A-07870EB8192E}" Win64="$(var.Win64)"><File Id="SystemReflectionReaderDll" Name="System.Reflection.Reader.dll" KeyPath="yes" AssemblyManifest="SystemReflectionReaderDll" AssemblyApplication="SystemReflectionReaderDll" /></Component>
<Component Id="SystemReflectionWriter" Guid="{798DEF51-113C-4501-88E4-07C91197FF7B}" Win64="$(var.Win64)"><File Id="SystemReflectionWriterDll" Name="System.Reflection.Writer.dll" KeyPath="yes" AssemblyManifest="SystemReflectionWriterDll" AssemblyApplication="SystemReflectionWriterDll" /></Component>
<Component Id="SystemReflectionResourceManager" Guid="{5781435A-794E-4B5D-A268-A9E67ABD409B}" Win64="$(var.Win64)"><File Id="SystemReflectionResourceManagerDll" Name="System.Reflection.ResourceManager.dll" KeyPath="yes" AssemblyManifest="SystemReflectionResourceManagerDll" AssemblyApplication="SystemReflectionResourceManagerDll" /></Component>
<Component Id="SystemRuntimeCompilerServicesUnsafe" Guid="{41E5C771-48C9-4517-BB8B-0DF79DEC1946}" Win64="$(var.Win64)"><File Id="SystemRuntimeCompilerServicesUnsafeDll" Name="System.Runtime.CompilerServices.Unsafe.dll" KeyPath="yes" AssemblyManifest="SystemRuntimeCompilerServicesUnsafeDll" AssemblyApplication="SystemRuntimeCompilerServicesUnsafeDll" /></Component>
<Component Id="SystemRuntimeCompilerServicesVisualC" Guid="{9AFD8ADF-262E-4328-87A9-DACD70407615}" Win64="$(var.Win64)"><File Id="SystemRuntimeCompilerServicesVisualCDll" Name="System.Runtime.CompilerServices.VisualC.dll" KeyPath="yes" AssemblyManifest="SystemRuntimeCompilerServicesVisualCDll" AssemblyApplication="SystemRuntimeCompilerServicesVisualCDll" /></Component>
<Component Id="SystemRuntimeInteropServicesRuntimeInformation" Guid="{2B901861-1D30-4E5D-ACB2-4D23CAB1A608}" Win64="$(var.Win64)"><File Id="SystemRuntimeInteropServicesRuntimeInformationDll" Name="System.Runtime.InteropServices.RuntimeInformation.dll" KeyPath="yes" AssemblyManifest="SystemRuntimeInteropServicesRuntimeInformationDll" AssemblyApplication="SystemRuntimeInteropServicesRuntimeInformationDll" /></Component>
<Component Id="SystemRuntimeNumerics" Guid="{73385D8A-38EF-4C70-A6AC-C7B0C98B5F2D}" Win64="$(var.Win64)"><File Id="SystemRuntimeNumericsDll" Name="System.Runtime.Numerics.dll" KeyPath="yes" AssemblyManifest="SystemRuntimeNumericsDll" AssemblyApplication="SystemRuntimeNumericsDll" /></Component>
<Component Id="SystemRuntimeSerializationFormatters" Guid="{CFD45728-929B-467B-A8A5-8D9C15B040E0}" Win64="$(var.Win64)"><File Id="SystemRuntimeSerializationFormattersDll" Name="System.Runtime.Serialization.Formatters.dll" KeyPath="yes" AssemblyManifest="SystemRuntimeSerializationFormattersDll" AssemblyApplication="SystemRuntimeSerializationFormattersDll" /></Component>
<Component Id="SystemSecurityClaims" Guid="{DF82E1E2-4158-498A-9E97-E48E5EF4B0F9}" Win64="$(var.Win64)"><File Id="SystemSecurityClaimsDll" Name="System.Security.Claims.dll" KeyPath="yes" AssemblyManifest="SystemSecurityClaimsDll" AssemblyApplication="SystemSecurityClaimsDll" /></Component>
<Component Id="SystemSecurityCryptographyCsp" Guid="{EADD2F9B-E989-4636-81C0-1BA4F700CA1E}" Win64="$(var.Win64)"><File Id="SystemSecurityCryptographyCspDll" Name="System.Security.Cryptography.Csp.dll" KeyPath="yes" AssemblyManifest="SystemSecurityCryptographyCspDll" AssemblyApplication="SystemSecurityCryptographyCspDll" /></Component>
<Component Id="SystemSecuritySecureString" Guid="{2DD26B3D-4F0E-4A0E-9E64-799FCF53627B}" Win64="$(var.Win64)"><File Id="SystemSecuritySecureStringDll" Name="System.Security.SecureString.dll" KeyPath="yes" AssemblyManifest="SystemSecuritySecureStringDll" AssemblyApplication="SystemSecuritySecureStringDll" /></Component>
<Component Id="SystemTextEncodingsWeb" Guid="{AC04D566-7FFC-49B3-A2F3-DF4977F2FDCC}" Win64="$(var.Win64)"><File Id="SystemTextEncodingsWebDll" Name="System.Text.Encodings.Web.dll" KeyPath="yes" AssemblyManifest="SystemTextEncodingsWebDll" AssemblyApplication="SystemTextEncodingsWebDll" /></Component>
<Component Id="SystemThreadingOverlapped" Guid="{71F7D488-D1EE-48E4-8194-9CD43EE92306}" Win64="$(var.Win64)"><File Id="SystemThreadingOverlappedDll" Name="System.Threading.Overlapped.dll" KeyPath="yes" AssemblyManifest="SystemThreadingOverlappedDll" AssemblyApplication="SystemThreadingOverlappedDll" /></Component>
<Component Id="SystemThreadingTasksExtensions" Guid="{F6CA0A08-B5C4-47BC-A469-D4120C9E972C}" Win64="$(var.Win64)"><File Id="SystemThreadingTasksExtensionsDll" Name="System.Threading.Tasks.Extensions.dll" KeyPath="yes" AssemblyManifest="SystemThreadingTasksExtensionsDll" AssemblyApplication="SystemThreadingTasksExtensionsDll" /></Component>
<Component Id="SystemThreadingThreadPool" Guid="{4BFC5CCA-0556-41C1-A29C-D58D70E0C1FF}" Win64="$(var.Win64)"><File Id="SystemThreadingThreadPoolDll" Name="System.Threading.ThreadPool.dll" KeyPath="yes" AssemblyManifest="SystemThreadingThreadPoolDll" AssemblyApplication="SystemThreadingThreadPoolDll" /></Component>

Step 1. ^(\{.*\}) (.*)$
Step 2. replace with '<Component _Id="$2" Guid="$1" Win64="$(var.Win64)"><File __Id="$2" Name="$2" KeyPath="yes" AssemblyManifest="___CId" AssemblyApplication="___CId" DiskId="1" Source="$(var.CitadelGUI x86.TargetDir)$2" /></Component>'
Step 3. Manually adjust component id
Step 4. replace '_Id="(.*)"( Guid=.*><File )__Id="(.*).dll" Name' with 'Id="$1"$2Id="$1Dll" Name'
Step 5. replace 'File Id="(.*)(" Name=.*)AssemblyManifest="(.*)" AssemblyApplication="(.*)"' with 'File Id="$1$2AssemblyManifest="(.*)" AssemblyApplication="(.*)"'